import 'package:agri_voltics/screens/integratedfarm/requirementscard.dart';
import 'package:agri_voltics/screens/projects/projectbanner.dart';
import 'package:agri_voltics/screens/projects/widget/content_section_widget.dart';
import 'package:agri_voltics/screens/projects/widget/content_section_widget2.dart';
import 'package:agri_voltics/screens/projects/widget/partnerwidget.dart';
import 'package:agri_voltics/widgets/Navbar.dart';
import 'package:flutter/material.dart';
import 'package:flutter_svg/flutter_svg.dart';
import 'package:go_router/go_router.dart';
import 'package:google_fonts/google_fonts.dart';
import 'package:video_player/video_player.dart';
import 'package:visibility_detector/visibility_detector.dart';
import '../widgets/header_widget.dart';
import '../widgets/footer_widget.dart';

class Projects extends StatefulWidget {
  const Projects({super.key});

  @override
  State<Projects> createState() => _ProjectsState();
}

class _ProjectsState extends State<Projects> with WidgetsBindingObserver {
  late VideoPlayerController _controller;
  bool _showPlayButton = true;

  @override
  void initState() {
    super.initState();
    WidgetsBinding.instance.addObserver(this);
    _controller = VideoPlayerController.networkUrl(Uri.parse(
        "https://nextagri.s3.ap-south-1.amazonaws.com/Agrivoltics+final.mp4"))
      ..initialize().then((_) {
        setState(() {});
        _controller.addListener(() {
          if (_controller.value.isPlaying && _showPlayButton) {
            setState(() {
              _showPlayButton = false;
            });
          } else if (!_controller.value.isPlaying && !_showPlayButton) {
            setState(() {
              _showPlayButton = true;
            });
          }
        });
      });
    GoRouter.of(context).routerDelegate.addListener(() {
      if (GoRouter.of(context).routerDelegate.currentConfiguration.fullPath !=
          '/projects') {
        // Stop video when navigating away
        if (_controller.value.isPlaying) {
          _controller.pause();
        }
      }
    });
  }

  @override
  void didChangeAppLifecycleState(AppLifecycleState state) {
    // Handle app lifecycle changes
    if (state == AppLifecycleState.paused ||
        state == AppLifecycleState.inactive) {
      // Pause video when app goes to background or becomes inactive
      if (_controller.value.isPlaying) {
        _controller.pause();
      }
    }
  }

  void _togglePlayPause() {
    setState(() {
      if (_controller.value.isPlaying) {
        _controller.pause();
      } else {
        _controller.play();
      }
    });
  }

  void _handleVisibility(double visibleFraction) {
    if (visibleFraction < 0.5) {
      _controller.pause();
    } else {
      // if (!_controller.value.isPlaying) {
      //   _controller.play();
      // }
    }
  }

  @override
  void dispose() {
    // Stop and dispose video when navigating away
    if (_controller.value.isPlaying) {
      _controller.pause();
    }
    _controller.dispose();
    WidgetsBinding.instance.removeObserver(this);
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    final screenWidth = MediaQuery.of(context).size.width;
    // final isDesktop = screenWidth > 991;
    // List<bool> _isHovered = [false, false, false];
    return LayoutBuilder(builder: (context, constraints) {
      bool isMobile = constraints.maxWidth <= 800;
      return Scaffold(
        drawer: isMobile ? MyDrawer() : null,
        backgroundColor: Color(0xfff3f8f2),
        body: SingleChildScrollView(
          child: Column(
            children: [
              const HeaderWidget(),
              Projectbanner(),
              SizedBox(
                height: 60,
              ),
              // ContactForm(),
              Column(
                crossAxisAlignment: CrossAxisAlignment.center,
                mainAxisAlignment: MainAxisAlignment.center,
                spacing: 10,
                children: [
                  Text(
                    'The Kavel',
                    style: GoogleFonts.freehand(
                        color: Colors.black,
                        fontSize: isMobile ? 65 : 90,
                        height: 0.8),
                  ),
                  SvgPicture.string(
                    '''<svg width="471" height="94" viewBox="0 0 471 94" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M231.991 1.3682C223.213 7.14502 214.519 17.0264 212.597 23.4113C212.262 24.4755 211.844 25.3369 211.677 25.3369C211.426 25.3369 209.002 24.2221 206.243 22.9046C200.559 20.1175 186.264 15.2528 179.827 13.8846C172.888 12.4151 172.47 12.7698 173.055 19.1547C173.223 22.1952 174.226 26.4518 175.229 28.8334C176.232 31.1644 176.901 33.1914 176.65 33.3434C176.399 33.4954 173.473 33.09 170.13 32.4819C162.689 31.1644 161.352 31.1644 160.349 32.3806C159.262 33.5968 161.268 41.4512 163.693 45.3024C168.625 53.4102 179.743 59.6938 193.871 62.4302C196.964 63.0383 199.555 63.697 199.555 63.8491C199.555 64.0011 194.79 64.9639 188.939 66.028C183.003 67.0415 174.059 68.6631 168.959 69.6259C163.86 70.5887 156.002 71.7035 151.571 72.1089C142.793 72.9197 140.954 73.4264 142.71 74.7439C143.462 75.2507 145.301 75.504 148.98 75.504C154.664 75.504 163.358 76.4162 176.483 78.3418C197.298 81.3822 207.33 80.2674 221.709 73.2744C224.885 71.7035 227.727 70.69 227.895 70.9941C228.396 72.0075 222.21 78.8992 218.699 81.0782C211.677 85.4361 199.388 87.6151 187.1 86.703C178.74 86.0442 174.895 85.5375 159.847 82.8518C132.678 78.0884 115.374 78.4938 90.4621 84.372C66.2191 90.0981 58.5282 91.2129 42.3941 91.2129C30.0218 91.2129 20.1574 90.3008 9.2063 88.0712C3.68894 86.9563 1.09745 86.6523 0.428674 87.0577C0.0106912 87.3111 -0.156502 87.8685 0.177884 88.1725C1.26464 89.2367 9.62428 91.2129 18.9035 92.6318C26.9288 93.848 29.2695 94 42.8121 94C60.8689 94 64.7144 93.4933 87.6198 88.2739C111.027 82.9531 120.891 81.7876 135.855 82.6491C144.716 83.1558 147.726 83.5105 162.355 86.1456C182.836 89.7434 195.376 90.5542 205.825 88.9326C217.194 87.1084 223.715 83.6119 229.985 75.9094C232.325 73.0717 234.666 70.69 235.251 70.5887C235.836 70.4367 238.01 72.5143 240.518 75.504C242.942 78.4431 246.453 81.7369 248.627 83.1558C259.243 90.0474 277.133 91.517 301.125 87.3617C329.046 82.5984 325.786 82.9531 341.669 82.9024C358.807 82.8518 359.643 82.9531 382.883 88.2232C406.206 93.4426 410.051 93.9493 428.192 93.9493C441.818 94 444.075 93.848 452.1 92.6318C461.38 91.2129 469.739 89.2367 470.826 88.1725C471.16 87.8685 470.993 87.3111 470.492 87.007C469.906 86.6523 467.315 86.9563 461.463 88.0712C447.921 90.7569 440.898 91.365 425.684 91.0609C409.717 90.8075 405.537 90.1995 383.886 85.1827C363.739 80.5208 358.472 79.8113 343.341 79.8113C329.966 79.862 323.111 80.5208 308.231 83.3585C278.471 88.9833 259.745 87.6658 249.797 79.2539C246.787 76.7202 242.775 71.7035 243.193 70.9434C243.36 70.69 246.202 71.8049 249.63 73.4264C264.594 80.6728 273.288 81.4329 298.199 77.7337C305.723 76.6695 313.581 75.8588 318.931 75.6561C324.867 75.4534 327.792 75.1493 328.461 74.5919C329.882 73.6291 327.291 72.4636 323.613 72.4636C319.015 72.4636 309.318 71.0447 294.019 68.1563C285.994 66.6361 277.635 65.1666 275.461 64.8119C270.78 64.1531 270.362 63.545 274.207 63.0889C275.628 62.8863 280.059 61.8221 283.904 60.7073C296.109 57.1601 306.225 49.6097 309.067 41.8566C310.739 37.296 311.408 33.1914 310.572 32.2793C309.652 31.1644 308.231 31.1644 300.874 32.4819C297.531 33.09 294.605 33.4954 294.437 33.3434C294.187 33.1914 294.772 31.1644 295.691 28.8334C296.611 26.5024 297.614 22.1445 297.949 19.1547C298.534 12.7698 298.116 12.4151 291.177 13.8846C284.657 15.2528 270.362 20.1175 264.677 22.9046C261.918 24.2728 259.494 25.3369 259.327 25.2356C259.243 25.1342 258.491 23.614 257.739 21.7898C255.231 15.8102 248.71 8.51321 240.351 2.38167C238.511 1.06415 236.338 0 235.586 0C234.75 0 233.161 0.608093 231.991 1.3682ZM237.843 10.4895C245.701 25.6917 245.868 42.6167 238.261 59.1364C237.09 61.7208 235.836 63.8491 235.502 63.8491C234.75 63.8491 231.824 57.7682 230.152 52.9542C226.724 43.0728 226.39 29.6442 229.232 20.0162C230.737 14.6954 234.415 7.09435 235.418 7.09435C235.753 7.09435 236.923 8.61456 237.843 10.4895ZM226.641 13.4286C223.715 20.979 222.712 26.2491 222.795 34.7116C222.795 42.7687 223.464 46.3159 226.724 56.6534C227.727 59.8965 220.287 49.4577 218.281 44.8464C215.188 37.8534 215.021 28.5294 217.779 22.6512C219.953 18.0906 226.641 9.62804 227.644 10.2361C227.727 10.3375 227.309 11.7563 226.641 13.4286ZM248.877 15.9623C253.893 22.1951 255.064 25.5396 254.98 33.1914C254.98 38.5628 254.562 40.6911 252.806 44.6943C250.884 49.0523 244.614 58.2749 243.611 58.2749C243.36 58.2749 243.694 57.0588 244.363 55.5892C249.463 43.7315 249.546 26.6038 244.614 14.4927C243.778 12.3137 243.026 10.3375 243.026 10.1854C243.109 9.47601 245.868 12.2124 248.877 15.9623ZM192.868 20.5736C202.063 23.7154 206.661 25.8943 209.754 28.7321C211.677 30.455 211.928 31.2658 212.346 36.5865L212.764 42.566L208.417 39.1202C205.992 37.2453 200.475 33.09 196.128 29.8469C188.27 24.0701 180.328 17.6345 180.328 17.0264C180.328 16.5197 184.592 17.6852 192.868 20.5736ZM287.081 20.3709C285.075 22.1445 278.888 26.8571 273.371 30.9111C267.937 34.965 262.336 39.2722 260.999 40.4377C259.578 41.6032 258.24 42.566 257.989 42.566C257.655 42.566 257.739 41.6032 258.157 40.3871C258.491 39.2216 258.825 36.5865 258.909 34.5596C258.909 32.3806 259.411 30.303 260.079 29.4415C261.5 27.7693 267.519 24.3741 272.034 22.6512C277.635 20.5229 290.007 16.6717 290.425 16.9251C290.676 17.0771 289.171 18.5973 287.081 20.3709ZM180.913 21.8911C182.335 23.1073 187.852 27.3639 193.119 31.3671C203.234 38.9682 209.253 43.9849 213.767 48.6469L216.442 51.434L211.593 48.6469C203.484 44.0356 197.884 41.2992 190.193 38.3094L182.92 35.5224L181.248 32.0766C179.827 28.9855 178.907 26.6038 177.486 21.3844C176.901 19.2054 177.904 19.3574 180.913 21.8911ZM293.016 22.9046C292.348 25.9957 291.679 27.7186 289.338 32.786C288.084 35.3197 287.75 35.5731 280.811 38.3094C273.371 41.1978 267.937 43.8329 259.829 48.3935L255.231 50.9272L257.989 47.8868C261.668 43.9342 267.185 39.2722 278.303 31.0124C283.236 27.3132 288.502 23.2593 289.84 21.9925C291.261 20.7763 292.682 19.7628 293.1 19.7628C293.434 19.7628 293.434 21.1817 293.016 22.9046ZM175.145 36.2825C188.772 39.5256 204.989 47.0253 218.448 56.1973C222.795 59.1364 226.306 61.7208 226.306 61.9235C226.306 62.5822 211.844 59.2377 203.401 56.6027C188.772 52.0927 178.406 46.7213 172.219 40.4377C169.544 37.752 167.956 34.965 169.043 34.965C169.294 34.965 172.136 35.5731 175.145 36.2825ZM299.453 39.4749C297.781 41.4005 294.354 44.3903 291.762 46.0625C283.988 51.2819 266.265 57.7682 250.717 61.062C247.623 61.7208 244.948 62.1768 244.781 62.0248C243.611 61.3154 263.423 48.9509 273.371 44.1876C276.882 42.4647 282.316 40.235 285.325 39.2216C291.762 37.0426 301.878 34.8129 302.212 35.4717C302.379 35.7251 301.125 37.5493 299.453 39.4749ZM168.207 41.3499C171.3 44.593 182.084 51.2819 188.688 54.1704C191.614 55.4372 198.218 57.8189 203.317 59.3898C213.265 62.5315 213.014 62.8863 202.063 61.3154C188.521 59.3391 176.566 54.6771 171.467 49.3563C168.792 46.5693 164.445 39.0189 165.615 39.0189C165.782 39.0189 166.953 40.083 168.207 41.3499ZM303.717 43.3768C302.546 45.5558 300.54 48.3935 299.202 49.6604C293.602 55.0318 282.316 59.3391 268.941 61.3154C257.989 62.8863 257.739 62.5315 267.687 59.3898C272.786 57.8189 279.39 55.4372 282.316 54.1704C288.92 51.2819 299.704 44.593 302.797 41.3499C304.051 40.0323 305.221 39.0695 305.389 39.1709C305.639 39.2722 304.803 41.1979 303.717 43.3768ZM213.349 67.6496C203.568 70.4873 188.27 72.5143 176.566 72.4636C170.882 72.4129 172.47 71.9569 186.682 69.4232C199.137 67.1935 209.336 65.9774 215.439 65.9774H219.201L213.349 67.6496ZM269.944 67.1429C279.557 68.4097 296.527 71.5515 296.527 72.1089C296.527 72.7677 283.486 72.2102 275.043 71.1461C268.523 70.386 254.228 67.2442 252.639 66.2814C251.552 65.572 261.751 66.1294 269.944 67.1429ZM225.888 67.8016C220.538 70.4873 211.343 74.2372 207.414 75.352C201.478 76.9736 191.447 77.4803 182.753 76.5175C174.895 75.7067 174.727 74.9973 182.251 74.9973C193.704 74.9973 206.828 72.9704 219.619 69.2205C225.888 67.3962 227.309 67.0415 225.888 67.8016ZM256.568 70.6394C265.095 73.0717 274.959 74.4906 285.827 74.8453C290.759 74.9973 294.605 75.3013 294.437 75.5547C293.601 76.3148 282.567 77.1256 275.628 76.9229C267.018 76.7202 261.584 75.352 252.221 71.0954C242.524 66.6868 242.608 66.6868 256.568 70.6394Z" fill="#BF0000"/>
</svg>
''',
                    width: isMobile ? 220 : 270,
                  )
                ],
              ),
              SizedBox(
                height: 0,
              ),
              ContentSectionWidget(
                  title: 'About our agrivoltaics project',
                  description:
                      "Our pioneering project in Tamil Nadu reconnects people with nature by combining clean energy and organic cultivation, fostering responsibility for the environment. By empowering local communities through sustainable work, we nurture both human wellbeing and the land. This initiative sets a new benchmark for holistic rural development, showing that caring for nature and ourselves go hand in hand. Join us in building a future where people and nature thrive together.",
                  imageUrl:
                      'https://nextagri.s3.ap-south-1.amazonaws.com/Agrivoltaics/Projects/About+our+agrivoltics+project.png'),
              Padding(
                padding: EdgeInsets.only(
                  top: 0,
                ),
                child: Wrap(
                  spacing: 40,
                  runSpacing: 40,
                  alignment: WrapAlignment.center,
                  children: [
                    SizedBox(
                      width: _getCardWidth(screenWidth),
                      child: RequirementCard(
                        svgIcon:
                            '''<svg width="84" height="83" viewBox="0 0 84 83" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="42" cy="41.5" r="41.5" fill="white"/>
      <circle cx="42" cy="41.5" r="39" stroke="#7B9540"/>
      <g clip-path="url(#clip0_1478_2152)">
      <mask id="mask0_1478_2152" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="20" y="20" width="45" height="44">
      <path d="M64.5 20H20.5V64H64.5V20Z" fill="white"/>
      </mask>
      <g mask="url(#mask0_1478_2152)">
      <path d="M64.4725 48.6959C64.4694 48.6849 64.4663 48.6746 64.4626 48.6636C64.444 48.611 64.4182 48.5613 64.3859 48.5158C64.3842 48.5131 64.3835 48.51 64.3814 48.5072L57.5009 39.2394C57.445 39.164 57.3722 39.1028 57.2882 39.0605C57.2044 39.0183 57.1118 38.9963 57.018 38.9963H27.982C27.8882 38.9963 27.7956 39.0183 27.7118 39.0605C27.6278 39.1028 27.555 39.164 27.4991 39.2394L20.6186 48.5076C20.6165 48.5103 20.6162 48.5134 20.6141 48.5161C20.5818 48.5616 20.556 48.6114 20.5375 48.664C20.5337 48.6746 20.5306 48.6853 20.5275 48.6963C20.5101 48.7513 20.5009 48.8087 20.5 48.8664V51.2551C20.5006 51.7792 20.7091 52.2815 21.0796 52.6521C21.4502 53.0226 21.9525 53.2311 22.4766 53.2317H38.9766V56.9511H36.8072C36.6644 56.9512 36.5264 57.002 36.4177 57.0944L32.9774 60.0163C32.911 60.0727 32.8576 60.1429 32.821 60.2221C32.7844 60.3012 32.7654 60.3873 32.7654 60.4745V63.3964C32.7654 63.556 32.8287 63.7089 32.9415 63.8218C33.0544 63.9346 33.2074 63.998 33.3669 63.998H51.6328C51.7923 63.998 51.9453 63.9346 52.0581 63.8218C52.1709 63.7089 52.2343 63.556 52.2343 63.3964V60.4745C52.2343 60.3873 52.2153 60.3012 52.1787 60.2221C52.142 60.1429 52.0887 60.0727 52.0222 60.0163L48.582 57.0944C48.4733 57.002 48.3352 56.9512 48.1925 56.9511H46.0234V53.231H62.5234C63.0474 53.2304 63.5499 53.022 63.9204 52.6514C64.2909 52.2809 64.4994 51.7785 64.5 51.2545V48.8661C64.4991 48.8083 64.4899 48.751 64.4725 48.6959ZM32.7316 48.2645L34.3738 44.3279H41.8208V48.2645H32.7316ZM22.2975 48.2645L25.2193 44.3282H33.0699L31.4278 48.2645H22.2975ZM41.8225 40.1998V43.1251H34.8756L36.096 40.1998H41.8225ZM48.7504 40.1998L49.9707 43.1251H43.027V40.1998H48.7504ZM43.0239 44.3279H50.4712L52.1133 48.2642H43.0239V44.3279ZM53.4168 48.2645L51.7747 44.3279H59.7803L62.7022 48.2642L53.4168 48.2645ZM58.8869 43.1251H51.2728L50.0525 40.1998H56.7151L58.8869 43.1251ZM28.2846 40.1998H34.7921L33.5718 43.1251H26.1124L28.2846 40.1998ZM51.0312 60.7536V62.7969H33.9688V60.7536L37.0282 58.1539H47.9715L51.0312 60.7536ZM44.8203 56.9504H40.1797V53.231H44.8203V56.9504ZM62.5234 52.0279H22.4766C22.2715 52.0277 22.0749 51.9462 21.9299 51.8012C21.7849 51.6562 21.7033 51.4595 21.7031 51.2545V49.467H63.2969V51.2545C63.2967 51.4595 63.2151 51.6562 63.0702 51.8012C62.9252 51.9462 62.7285 52.0277 62.5234 52.0279Z" fill="#7B9540"/>
      <path d="M42.4998 32.5607C43.2781 32.5607 44.0388 32.33 44.686 31.8976C45.3331 31.4652 45.8374 30.8507 46.1352 30.1316C46.4331 29.4127 46.511 28.6215 46.3591 27.8582C46.2073 27.0949 45.8326 26.3937 45.2823 25.8434C44.732 25.2931 44.0308 24.9184 43.2675 24.7665C42.5042 24.6147 41.713 24.6926 40.994 24.9904C40.275 25.2883 39.6604 25.7926 39.2281 26.4397C38.7957 27.0868 38.5649 27.8476 38.5649 28.6258C38.566 29.6691 38.9809 30.6693 39.7187 31.407C40.4563 32.1447 41.4566 32.5596 42.4998 32.5607ZM42.4998 25.894C43.0402 25.894 43.5683 26.0543 44.0176 26.3544C44.4668 26.6546 44.8169 27.0813 45.0237 27.5804C45.2304 28.0796 45.2846 28.6288 45.1791 29.1588C45.0737 29.6887 44.8136 30.1754 44.4315 30.5575C44.0494 30.9396 43.5627 31.1997 43.0328 31.3051C42.5029 31.4105 41.9536 31.3564 41.4545 31.1497C40.9553 30.9429 40.5286 30.5928 40.2284 30.1435C39.9283 29.6943 39.7681 29.1661 39.7681 28.6258C39.7689 27.9016 40.0569 27.2072 40.5691 26.6951C41.0812 26.1829 41.7756 25.8949 42.4998 25.894Z" fill="#7B9540"/>
      <path d="M42.4221 23.3086C42.5817 23.3086 42.7347 23.2452 42.8475 23.1324C42.9603 23.0196 43.0236 22.8666 43.0236 22.707V20.6016C43.0236 20.442 42.9603 20.289 42.8475 20.1762C42.7347 20.0634 42.5817 20 42.4221 20C42.2626 20 42.1096 20.0634 41.9968 20.1762C41.8839 20.289 41.8206 20.442 41.8206 20.6016V22.707C41.8206 22.8666 41.8839 23.0196 41.9968 23.1324C42.1096 23.2452 42.2626 23.3086 42.4221 23.3086Z" fill="#7B9540"/>
      <path d="M41.8206 34.5447V36.6502C41.8206 36.8097 41.8839 36.9627 41.9968 37.0756C42.1096 37.1884 42.2626 37.2517 42.4221 37.2517C42.5817 37.2517 42.7347 37.1884 42.8475 37.0756C42.9603 36.9627 43.0236 36.8097 43.0236 36.6502V34.5447C43.0236 34.3852 42.9603 34.2321 42.8475 34.1193C42.7347 34.0065 42.5817 33.9431 42.4221 33.9431C42.2626 33.9431 42.1096 34.0065 41.9968 34.1193C41.8839 34.2321 41.8206 34.3852 41.8206 34.5447Z" fill="#7B9540"/>
      <path d="M46.6076 25.0422C46.6866 25.0422 46.7648 25.0267 46.8378 24.9964C46.9108 24.9662 46.977 24.9218 47.0328 24.8658L48.5216 23.377C48.6295 23.2633 48.6887 23.1119 48.6866 22.9551C48.6845 22.7984 48.6213 22.6486 48.5104 22.5378C48.3996 22.4269 48.2498 22.3637 48.0931 22.3616C47.9363 22.3595 47.7849 22.4187 47.6712 22.5266L46.1824 24.0154C46.0983 24.0995 46.0411 24.2067 46.0179 24.3233C45.9947 24.44 46.0066 24.5609 46.0521 24.6708C46.0976 24.7807 46.1747 24.8746 46.2736 24.9407C46.3724 25.0068 46.4886 25.0421 46.6076 25.0422Z" fill="#7B9540"/>
      <path d="M37.8115 32.3857L36.3227 33.8745C36.2099 33.9873 36.1465 34.1403 36.1465 34.2998C36.1465 34.4594 36.2099 34.6124 36.3227 34.7252C36.4355 34.8381 36.5885 34.9014 36.7481 34.9014C36.9076 34.9014 37.0607 34.8381 37.1735 34.7252L38.6623 33.2365C38.7751 33.1236 38.8385 32.9706 38.8385 32.811C38.8385 32.6515 38.7751 32.4985 38.6623 32.3857C38.5494 32.2729 38.3964 32.2095 38.2369 32.2095C38.0773 32.2095 37.9243 32.2729 37.8115 32.3857Z" fill="#7B9540"/>
      <path d="M47.7402 28.6257C47.7402 28.7853 47.8036 28.9383 47.9164 29.0511C48.0293 29.1639 48.1822 29.2273 48.3418 29.2273H50.4473C50.6068 29.2273 50.7598 29.1639 50.8726 29.0511C50.9854 28.9383 51.0488 28.7853 51.0488 28.6257C51.0488 28.4662 50.9854 28.3132 50.8726 28.2004C50.7598 28.0876 50.6068 28.0242 50.4473 28.0242H48.3418C48.1822 28.0242 48.0293 28.0876 47.9164 28.2004C47.8036 28.3132 47.7402 28.4662 47.7402 28.6257Z" fill="#7B9540"/>
      <path d="M34.398 29.2273H36.5034C36.6629 29.2273 36.816 29.1639 36.9288 29.0511C37.0416 28.9383 37.105 28.7853 37.105 28.6257C37.105 28.4662 37.0416 28.3132 36.9288 28.2004C36.816 28.0876 36.6629 28.0242 36.5034 28.0242H34.398C34.2384 28.0242 34.0854 28.0876 33.9726 28.2004C33.8598 28.3132 33.7964 28.4662 33.7964 28.6257C33.7964 28.7853 33.8598 28.9383 33.9726 29.0511C34.0854 29.1639 34.2384 29.2273 34.398 29.2273Z" fill="#7B9540"/>
      <path d="M46.1817 32.3856C46.1258 32.4414 46.0814 32.5077 46.0512 32.5807C46.0209 32.6537 46.0054 32.732 46.0054 32.811C46.0054 32.89 46.0209 32.9682 46.0512 33.0412C46.0814 33.1142 46.1258 33.1805 46.1817 33.2364L47.6705 34.7252C47.7833 34.838 47.9363 34.9014 48.0959 34.9014C48.2555 34.9014 48.4084 34.838 48.5213 34.7252C48.6341 34.6123 48.6975 34.4593 48.6975 34.2997C48.6975 34.1402 48.6341 33.9872 48.5213 33.8744L47.0325 32.3856C46.9766 32.3297 46.9103 32.2853 46.8373 32.2551C46.7644 32.2248 46.6861 32.2092 46.6071 32.2092C46.5281 32.2092 46.4498 32.2248 46.3769 32.2551C46.3039 32.2853 46.2375 32.3297 46.1817 32.3856Z" fill="#7B9540"/>
      <path d="M37.8118 24.8658C37.9246 24.9786 38.0777 25.042 38.2372 25.042C38.3968 25.042 38.5498 24.9786 38.6626 24.8658C38.7754 24.7529 38.8388 24.5999 38.8388 24.4404C38.8388 24.2808 38.7754 24.1278 38.6626 24.015L37.1735 22.5265C37.0607 22.4137 36.9076 22.3503 36.7481 22.3503C36.5885 22.3503 36.4355 22.4137 36.3227 22.5265C36.2099 22.6394 36.1465 22.7924 36.1465 22.9519C36.1465 23.1115 36.2099 23.2645 36.3227 23.3773L37.8118 24.8658Z" fill="#7B9540"/>
      </g>
      </g>
      <defs>
      <clipPath id="clip0_1478_2152">
      <rect width="44" height="44" fill="white" transform="translate(20.5 20)"/>
      </clipPath>
      </defs>
      </svg>
      ''',
                        title: 'Benefits for solar companies',
                        description:
                            'Solar companies can save money on maintenance costs by using sheep instead of mowing the grass between panels.',
                      ),
                    ),
                    SizedBox(
                      width: _getCardWidth(screenWidth),
                      child: RequirementCard(
                        svgIcon:
                            '''<svg width="84" height="83" viewBox="0 0 84 83" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="42" cy="41.5" r="41.5" fill="white"/>
      <circle cx="42" cy="41.5" r="39" stroke="#7B9540"/>
      <g clip-path="url(#clip0_1478_2174)">
      <mask id="mask0_1478_2174" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="20" y="20" width="45" height="44">
      <path d="M64.5 20H20.5V64H64.5V20Z" fill="white"/>
      </mask>
      <g mask="url(#mask0_1478_2174)">
      <path d="M37.7918 58.0653C37.8913 58.1111 37.9962 58.1334 38.1001 58.1334C38.33 58.1334 38.5541 58.0253 38.6955 57.8287L51.8955 39.4953C52.0564 39.2719 52.0785 38.9772 51.9532 38.7323C51.8276 38.4874 51.5758 38.3334 51.3005 38.3334H44.7298L47.6119 26.7776C47.6972 26.4363 47.5281 26.0827 47.209 25.9347C46.8882 25.7872 46.5101 25.8857 46.3052 26.1714L33.1052 44.5047C32.9444 44.7282 32.9223 45.0228 33.0476 45.2678C33.1732 45.5127 33.425 45.6667 33.7004 45.6667H40.271L37.3888 57.2224C37.3037 57.5636 37.4728 57.9174 37.7918 58.0653ZM41.9215 45.1109C41.9763 44.8918 41.9268 44.6598 41.7879 44.4818C41.6491 44.3038 41.4356 44.2 41.21 44.2H35.1321L45.2652 30.1263L43.0794 38.8891C43.0246 39.1082 43.0741 39.3402 43.213 39.5182C43.3518 39.6962 43.5653 39.8 43.7909 39.8H49.8688L39.7357 53.8737L41.9215 45.1109Z" fill="#435F02"/>
      <path d="M63.7673 41.2668C63.3622 41.2668 63.0339 41.5952 63.0339 42.0002C63.0339 53.3224 53.8229 62.5335 42.5006 62.5335C36.438 62.5335 30.67 59.8142 26.7855 55.2002H30.7673C31.1723 55.2002 31.5005 54.8718 31.5005 54.4668C31.5005 54.0618 31.1722 53.7335 30.7673 53.7335H24.9005C24.4955 53.7335 24.1672 54.0619 24.1672 54.4668V60.3335C24.1672 60.7386 24.4956 61.0668 24.9005 61.0668C25.3055 61.0668 25.6338 60.7385 25.6338 60.3335V56.11C29.7956 61.074 35.9895 64.0002 42.5006 64.0002C54.6313 64.0002 64.5006 54.1309 64.5006 42.0002C64.5006 41.5951 64.1722 41.2668 63.7673 41.2668Z" fill="#435F02"/>
      <path d="M42.5 21.4667C48.5626 21.4667 54.3306 24.1859 58.2152 28.8H54.2334C53.8284 28.8 53.5001 29.1284 53.5001 29.5333C53.5001 29.9382 53.8285 30.2666 54.2334 30.2666H60.1C60.505 30.2666 60.8333 29.9382 60.8333 29.5333V23.6667C60.8333 23.2617 60.505 22.9334 60.1 22.9334C59.695 22.9334 59.3667 23.2618 59.3667 23.6667V27.8902C55.2049 22.9262 49.0111 20 42.5 20C30.3693 20 20.5 29.8693 20.5 42C20.5 42.405 20.8284 42.7333 21.2333 42.7333C21.6382 42.7333 21.9666 42.405 21.9666 42C21.9667 30.6777 31.1777 21.4667 42.5 21.4667Z" fill="#435F02"/>
      </g>
      </g>
      <defs>
      <clipPath id="clip0_1478_2174">
      <rect width="44" height="44" fill="white" transform="translate(20.5 20)"/>
      </clipPath>
      </defs>
      </svg>
      ''',
                        title: 'Benefits for the environment',
                        description:
                            'Agrivoltaics can reduce the environmental impacts of producing food and electricity. For example, sheep grazing can help sequester carbon and improve soil quality.',
                      ),
                    ),
                    SizedBox(
                      width: _getCardWidth(screenWidth),
                      child: RequirementCard(
                        svgIcon:
                            '''<svg width="84" height="83" viewBox="0 0 84 83" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="42" cy="41.5" r="41.5" fill="white"/>
      <circle cx="42" cy="41.5" r="39" stroke="#7B9540"/>
      <g clip-path="url(#clip0_1478_2189)">
      <mask id="mask0_1478_2189" style="mask-type:luminance" maskUnits="userSpaceOnUse" x="21" y="20" width="44" height="44">
      <path d="M65 20H21V64H65V20Z" fill="white"/>
      </mask>
      <g mask="url(#mask0_1478_2189)">
      <path d="M64.7804 42.8043L61.1973 39.6978C61.7905 38.8703 62.2476 37.9744 62.2476 37.1778C62.2476 34.9222 60.4124 33.087 58.1569 33.087C56.9561 33.087 55.8745 33.6073 55.1256 34.4341L46.6191 27.0593C46.9054 26.5168 47.0907 25.9713 47.0907 25.4658C47.0907 23.2102 45.2555 21.375 43 21.375C40.7445 21.375 38.9093 23.2102 38.9093 25.4658C38.9093 25.974 39.0969 26.5229 39.3856 27.0683L30.8976 34.461C30.148 33.6188 29.0567 33.087 27.8431 33.087C25.5876 33.087 23.7524 34.9222 23.7524 37.1778C23.7524 37.9885 24.226 38.9022 24.8346 39.7418L21.2185 42.8913C20.9272 43.1447 20.9272 43.612 21.2185 43.8654L42.5757 62.4672C42.8164 62.6767 43.1853 62.6764 43.4253 62.4662L55.2001 52.1631C55.4687 51.9285 55.4958 51.5203 55.2609 51.2517C55.0259 50.9835 54.6177 50.9563 54.3494 51.1909L52.3769 52.9171L45.0239 44.5137V40.3138L54.1118 35.2647L54.4152 35.5279C54.1917 36.0327 54.0664 36.591 54.0664 37.1778C54.0664 39.3178 57.3633 42.1746 57.7393 42.4931C57.9773 42.6949 58.3368 42.6949 58.5745 42.4931C58.7507 42.3438 59.5691 41.6364 60.3889 40.7066L63.3742 43.2944L56.7376 49.1012C56.4902 49.3178 56.4465 49.6978 56.6386 49.9646C56.8577 50.2695 57.3052 50.3212 57.5882 50.0734L64.7828 43.7782C65.0735 43.524 65.0722 43.0571 64.7804 42.8043ZM43 22.6667C44.5432 22.6667 45.7987 23.9222 45.7987 25.4658C45.7987 26.5074 44.2226 28.3027 43 29.4259C42.24 28.7277 41.3437 27.77 40.7737 26.8945C40.7613 26.8723 40.7475 26.8508 40.7324 26.8297C40.4095 26.3211 40.201 25.8437 40.201 25.4654C40.201 23.9222 41.4565 22.6667 43 22.6667ZM42.5824 30.7808C42.8204 30.9829 43.1799 30.9829 43.4176 30.7808C43.6438 30.5891 44.9272 29.4783 45.9138 28.1577L53.0728 34.364L44.4767 39.1399L36.3136 31.4568L40.0922 28.1661C41.0781 29.483 42.3565 30.5898 42.5824 30.7808ZM27.8431 34.3791C29.3863 34.3791 30.6418 35.6346 30.6418 37.1778C30.6418 38.2198 29.0657 40.015 27.8431 41.1383C26.6205 40.0147 25.0441 38.2194 25.0441 37.1778C25.0441 35.6346 26.2996 34.3791 27.8431 34.3791ZM25.6473 40.7468C26.4547 41.6566 27.2516 42.3458 27.4255 42.4931C27.6632 42.6949 28.0227 42.6949 28.2607 42.4931C28.6367 42.1746 31.9336 39.3178 31.9336 37.1778C31.9336 36.604 31.8144 36.0579 31.6002 35.562L35.3344 32.3096L43.7318 40.2128V44.1105H37.4882C37.3483 44.1105 37.2123 44.1558 37.1005 44.2394L29.8542 49.6743L22.6258 43.3783L25.6473 40.7468ZM42.999 61.1228L30.8506 50.5417L37.7038 45.4019H44.085L51.4048 53.7677L42.999 61.1228ZM58.1569 41.1383C56.9343 40.0147 55.3579 38.2194 55.3579 37.1778C55.3579 35.6346 56.6137 34.3791 58.1569 34.3791C59.7001 34.3791 60.9559 35.6346 60.9559 37.1778C60.9559 38.2194 59.3795 40.015 58.1569 41.1383Z" fill="#435F02"/>
      <path d="M42.9983 27.4893C44.1141 27.4893 45.0222 26.5816 45.0222 25.4658C45.0222 24.3496 44.1141 23.4419 42.9983 23.4419C41.8825 23.4419 40.9744 24.3496 40.9744 25.4658C40.9744 26.5816 41.8825 27.4893 42.9983 27.4893ZM42.9983 24.7336C43.4018 24.7336 43.7305 25.0619 43.7305 25.4658C43.7305 25.8693 43.4018 26.1976 42.9983 26.1976C42.5948 26.1976 42.2661 25.8693 42.2661 25.4658C42.2661 25.0619 42.5948 24.7336 42.9983 24.7336Z" fill="#435F02"/>
      <path d="M58.1553 35.1538C57.0394 35.1538 56.1313 36.0618 56.1313 37.1777C56.1313 38.2935 57.0394 39.2016 58.1553 39.2016C59.2711 39.2016 60.1792 38.2935 60.1792 37.1777C60.1792 36.0618 59.2711 35.1538 58.1553 35.1538ZM58.1553 37.9098C57.7517 37.9098 57.4231 37.5815 57.4231 37.1777C57.4231 36.7742 57.7517 36.4459 58.1553 36.4459C58.5588 36.4459 58.8874 36.7742 58.8874 37.1777C58.8874 37.5815 58.5588 37.9098 58.1553 37.9098Z" fill="#435F02"/>
      <path d="M38.9094 53.0236C38.9094 55.1633 42.2066 58.0201 42.5825 58.3386C42.7027 58.441 42.8514 58.492 43.0002 58.492C43.1489 58.492 43.2973 58.441 43.4178 58.3386C43.7937 58.0201 47.0909 55.1633 47.0909 53.0236C47.0909 50.7677 45.2557 48.9329 43.0002 48.9329C40.7447 48.9329 38.9094 50.7677 38.9094 53.0236ZM45.7988 53.0236C45.7988 54.0653 44.2227 55.8605 43.0002 56.9838C41.7776 55.8605 40.2011 54.0649 40.2011 53.0236C40.2011 51.4801 41.4566 50.2246 43.0002 50.2246C44.5434 50.2246 45.7988 51.4801 45.7988 53.0236Z" fill="#435F02"/>
      <path d="M40.9744 53.0239C40.9744 54.1398 41.8825 55.0474 42.9983 55.0474C44.1141 55.0474 45.0222 54.1398 45.0222 53.0239C45.0222 51.9077 44.1141 51 42.9983 51C41.8825 51 40.9744 51.9077 40.9744 53.0239ZM43.7305 53.0239C43.7305 53.4274 43.4018 53.7557 42.9983 53.7557C42.5948 53.7557 42.2661 53.4274 42.2661 53.0239C42.2661 52.6201 42.5948 52.2918 42.9983 52.2918C43.4018 52.2918 43.7305 52.6201 43.7305 53.0239Z" fill="#435F02"/>
      <path d="M29.8652 37.1777C29.8652 36.0618 28.9571 35.1538 27.8413 35.1538C26.7254 35.1538 25.8174 36.0618 25.8174 37.1777C25.8174 38.2935 26.7254 39.2016 27.8413 39.2016C28.9571 39.2016 29.8652 38.2935 29.8652 37.1777ZM27.1091 37.1777C27.1091 36.7741 27.4374 36.4458 27.8413 36.4458C28.2448 36.4458 28.5731 36.7741 28.5731 37.1777C28.5731 37.5815 28.2448 37.9098 27.8413 37.9098C27.4374 37.9098 27.1091 37.5812 27.1091 37.1777Z" fill="#435F02"/>
      </g>
      </g>
      <defs>
      <clipPath id="clip0_1478_2189">
      <rect width="44" height="44" fill="white" transform="translate(21 20)"/>
      </clipPath>
      </defs>
      </svg>
      ''',
                        title: 'Benefits for the landscape',
                        description:
                            'Sheep grazing can help maintain vegetation under and around solar panels',
                      ),
                    ),
                  ],
                ),
              ),

              PartnersSection(),
              VisibilityDetector(
                key: Key('video-key'),
                onVisibilityChanged: (info) {
                  _handleVisibility(info.visibleFraction);
                },
                child: Padding(
                  padding: EdgeInsets.symmetric(
                      horizontal: isMobile ? 20 : 60, vertical: 0),
                  child: Container(
                    constraints: BoxConstraints(maxWidth: 1280),
                    decoration: BoxDecoration(),
                    clipBehavior: Clip.hardEdge,
                    child: Column(
                      children: [
                        Center(
                          child: Stack(
                            alignment: Alignment.center,
                            children: [
                              Container(
                                clipBehavior: Clip.hardEdge,
                                decoration: BoxDecoration(
                                    borderRadius:
                                        BorderRadius.all(Radius.circular(12))),
                                child: AspectRatio(
                                  aspectRatio: _controller.value.aspectRatio,
                                  child: _controller.value.isInitialized
                                      ? VideoPlayer(_controller)
                                      : Container(
                                          decoration:
                                              BoxDecoration(color: Colors.grey),
                                          child: SizedBox(
                                            width: 100,
                                            height: 100,
                                            child:
                                                const CircularProgressIndicator(
                                              padding: EdgeInsets.all(400),
                                              value: 0.3,
                                              constraints:
                                                  BoxConstraints(maxWidth: 300),
                                              color: Color(0xff7b9540),
                                            ),
                                          ),
                                        ),
                                ),
                              ),
                              // Overlay Play/Pause button
                              if (_showPlayButton)
                                GestureDetector(
                                  onTap: _togglePlayPause,
                                  child: Container(
                                    decoration: BoxDecoration(
                                      color: Colors.black45,
                                      shape: BoxShape.circle,
                                    ),
                                    padding: const EdgeInsets.all(12),
                                    child: Icon(
                                      Icons.play_arrow,
                                      color: Colors.white,
                                      size: 48,
                                    ),
                                  ),
                                ),
                              // Invisible tap layer for pausing too
                              Positioned.fill(
                                child: GestureDetector(
                                  onTap: _togglePlayPause,
                                  child: Container(color: Colors.transparent),
                                ),
                              ),
                            ],
                          ),
                        ),
                        SizedBox(
                          height: 30,
                        ),
                        Text(
                          "The above video showcases our journey of turning sunlight into power and soil into sustenance.â˜€ï¸ðŸŒ±Watch how we harness solar energy to fuel a future that's green, clean, and self-sustained. From powering our systems to nurturing crops through integrated farming, this is innovation rooted in nature. A smarter cycle, a brighter tomorrow.",
                          style: TextStyle(fontSize: 18, color: Colors.black),
                        ),
                      ],
                    ),
                  ),
                ),
              ),
              ContentSectionWidget2(
                  title: 'Powered by Progress: PM-KUSUM Scheme Agrivoltaics',
                  description:
                      "Our pioneering project in Tamil Nadu reconnects people with nature by combining clean energy and organic cultivation, fostering responsibility for the environment. By empowering local communities through sustainable work, we nurture both human wellbeing and the land. This initiative sets a new benchmark for holistic rural development, showing that caring for nature and ourselves go hand in hand. Join us in building a future where people and nature thrive together.",
                  imageUrl:
                      'https://nextagri.s3.ap-south-1.amazonaws.com/Agrivoltaics/Projects/powered+by+progress+PM++KUMSUM+scheme+agrivoltaics.png'),
              SizedBox(
                height: 0,
              ),
              FooterWidget()
            ],
          ),
        ),
      );
    });
  }
}

double _getCardWidth(double screenWidth) {
  screenWidth = screenWidth > 1280 ? 1280 : screenWidth;
  if (screenWidth <= 640) {
    return screenWidth - 48; // Full width minus padding
  } else if (screenWidth <= 991) {
    return (screenWidth - 80) / 2; // Half width minus spacing
  }
  return screenWidth / 4.8; // Default card width
}
